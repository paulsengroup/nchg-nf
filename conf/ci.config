// Copyright (C) 2025 Roberto Rossini <roberros@uio.no>
//
// SPDX-License-Identifier: MIT

process {
  executor       = 'local'
  resourceLimits = [ cpus: 2, memory: 8.GB, time: 30.m ]
  containerOptions = "--user root"

  cpus   = { 1    * task.attempt }
  memory = { 3.GB * task.attempt }
  time   = { 30.m * task.attempt }

  withLabel:duration_very_short {
    time   = { 5.m  * task.attempt  }
  }
  withLabel:duration_short {
    time   = { 10.m  * task.attempt }
  }
  withLabel:duration_long {
    time   = { 4.h  * task.attempt  }
  }
  withLabel:process_medium {
    cpus   = { 2     * task.attempt }
    memory = { 7.GB * task.attempt }
  }
  withLabel:process_high {
    cpus   = { 2    * task.attempt }
    memory = { 7.GB * task.attempt }
  }
  withLabel:process_very_high {
    cpus   = { 2    * task.attempt }
    memory = { 7.GB * task.attempt }
  }
  withLabel:error_ignore {
    errorStrategy = 'ignore'
  }
  withLabel:error_retry {
    errorStrategy = 'retry'
    maxRetries    = 2
  }
}

docker {
  enabled = true
  envWhitelist = 'HICTK_NO_TELEMETRY,NCHG_NO_TELEMETRY'
}
